(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){e.exports=n(33)},26:function(e,t,n){},28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),s=n.n(o),c=(n(26),n(2)),i=n(3),u=n(6),l=n(4),d=n(7),m=(n(28),n(5)),f=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onJoinClick=function(e){e.preventDefault();var t=n.props.joinFn,a=n.state,r=a.name;a.valid||t(r)},n.checkName=function(e){var t=e.target.value,a=t&&t.length>0,r=n.props.joinFn;n.setState({valid:a,name:t}),a&&"keydown"===e.type&&13===e.keyCode&&r(t)},n.state={valid:!1,name:null},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.valid;return r.a.createElement("div",null,r.a.createElement("input",{type:"text",maxLength:"20",placeholder:"Your name",onKeyDown:this.checkName,onChange:this.checkName}),r.a.createElement("button",{onClick:this.onJoinClick,disabled:e},"Join"))}}]),t}(a.Component),h=Object(m.b)(null,function(e){return{joinFn:function(t){return e(function(e){return function(t,n,a){(0,a.send)("joinRequested",{name:e})}}(t))}}})(f),g=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onSendClick=function(e){e.preventDefault();var t=n.state,a=t.message,r=t.valid,o=n.props.sendMessageFn;r&&a&&0!==a.length&&(o(a),n.setState({valid:!1,message:""}))},n.onChange=function(e){var t=e.target.value,a=t&&t.length>0;n.setState({valid:a,message:t})},n.onKeyDown=function(e){if("Enter"===e.key)return n.onSendClick(e)},n.state={valid:!1,name:null},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.valid;return r.a.createElement("div",null,r.a.createElement("input",{className:"send-message-form-input",placeholder:"Say something nice",maxLength:"200",onChange:this.onChange,onKeyDown:this.onKeyDown}),r.a.createElement("button",{onClick:this.onSendClick,disabled:!e},"Send"))}}]),t}(a.Component),v=Object(m.b)(null,function(e){return{sendMessageFn:function(t){return e(function(e){return function(t,n,a){var r=a.send;t({type:"messageSendRequested"}),r("messageAdded",{message:e})}}(t))}}})(g),p=function(e){var t=e.name,n=e.createdAt,a=e.message;return r.a.createElement("div",{className:"message"},r.a.createElement("span",{style:t&&{marginRight:"5px"}},t&&t+":"),r.a.createElement("span",{className:"text"},a),r.a.createElement("span",{className:"created-at"},function(e){var t=Date.now()-e;if(t<5e3)return"just now";var n=Math.floor(t/1e3),a=Math.floor(n/31536e3);return a>1?a+" yrs ago":(a=Math.floor(n/2592e3))>1?a+" mon ago":(a=Math.floor(n/86400))>1?a+" days ago":(a=Math.floor(n/3600))>1?a+" hr ago":(a=Math.floor(n/60))>1?a+" min ago":Math.floor(n)+" sec ago"}(n)))},O=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){this.messageList.scrollTop=this.messageList.scrollHeight}},{key:"render",value:function(){var e=this,t=this.props.messages;return r.a.createElement("div",{className:"message-list"},r.a.createElement("strong",null,"Messages"),r.a.createElement("div",{className:"messages-list",ref:function(t){e.messageList=t}},t.map(function(e,t){var n=e.id,a=e.user,o=e.message,s=e.createdAt;return r.a.createElement("span",{key:t},r.a.createElement(p,{key:n,name:a&&a.name,createdAt:s,message:o}))})))}}]),t}(a.Component),b=Object(m.b)(function(e){return{messages:e.messages}})(O),j=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{id:"page"},r.a.createElement("header",null,"Header"),r.a.createElement("nav",null,r.a.createElement(h,null),r.a.createElement(v,null)),r.a.createElement("main",null,r.a.createElement(b,null)))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(20);var y,E=n(8),k=n(9),w=n(10),S=(y={},Object(k.a)(y,"joinRequested",function(e){var t=e.state,n=e.payload;return Object(w.a)({},t,{currentUser:n})}),Object(k.a)(y,"userJoined",function(e){var t=e.state,n=e.payload;return Object(w.a)({},t,{users:t.users.concat([n])})}),Object(k.a)(y,"messageAdded",function(e){var t=e.state,n=e.payload,a=e.metadata.createdAt;return Object(w.a)({},t,{messages:t.messages.concat([Object(w.a)({},n,{createdAt:a})])})}),Object(k.a)(y,"usersRequested",function(e){var t=e.state,n=e.payload;return Object(w.a)({},t,{users:n})}),Object(k.a)(y,"userLeft",function(e){var t=e.state,n=e.payload.userId;return Object(w.a)({},t,{users:t.users.filter(function(e){return e.id!==n})})}),y),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.metadata,o=S[n];return o?o({state:e,payload:a,metadata:r}):e},N=n(11),M=function(){var e;return{getInstance:function(){return e||(e=function(){var e={PROTOCOL:"ws",HOST:"localhost",PORT:"9000/"};return e.HOST="",{getSocket:function(){return new WebSocket("".concat(e.PROTOCOL,"://").concat(e.HOST,":").concat(e.PORT))}}}()),e.getSocket()}}}(),R=function(){return new Promise(function(e,t){var n=M.getInstance(),a=function(e){n.onmessage=function(t){return e(JSON.parse(t.data))}},r=function(e,t){return n.send(JSON.stringify({type:e,payload:t}))};n.onopen=function(){return e({send:r,receive:a})},n.onclose=function(){n.close(),t(new Error("WebSocket Closed"))}})},J=new Promise(function(e,t){e(function(){var e={messages:[],users:[],currentUser:null};return R().then(function(t){var n=t.send,a=t.receive,r=[N.a.withExtraArgument({send:n})],o=Object(E.c)(C,e,E.a.apply(void 0,r));return a(o.dispatch),function(e){e("usersRequested")}(n),o}).catch(function(e){throw e})}().then(function(e){return e}))}),A=function(e){return r.a.createElement("div",null,JSON.stringify(e))};J.then(function(e){return s.a.render(r.a.createElement(m.a,{store:e},r.a.createElement(j,null)),document.getElementById("root"))}).catch(function(e){return s.a.render(r.a.createElement(A,{error:e.toString()}),document.getElementById("root"))}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,2,1]]]);
//# sourceMappingURL=main.28e1da5a.chunk.js.map