(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},22:function(e,t,n){e.exports=n(34)},27:function(e,t,n){},29:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(14),o=n.n(s),c=(n(27),n(29),n(3)),i=n(4),u=n(6),l=n(5),m=n(7),d=n(1),f=function(e){return e("@@user/usersRequested")},g=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onJoinClick=function(e){e.preventDefault();var t=n.props.joinFn,a=n.state,r=a.name;a.valid&&t(r)},n.checkName=function(e){var t=e.target.value,a=t&&t.length>0,r=n.props.joinFn;n.setState({valid:a,name:t}),a&&"keydown"===e.type&&13===e.keyCode&&r(t)},n.state={valid:!1,name:null},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.valid;return r.a.createElement("div",null,r.a.createElement("input",{style:{float:"left"},type:"text",maxLength:"20",placeholder:"Your name",onKeyDown:this.checkName,onChange:this.checkName}),r.a.createElement("button",{onClick:this.onJoinClick,disabled:!e},"Join"))}}]),t}(a.Component),h=Object(d.b)(null,function(e){return{joinFn:function(t){return e(function(e){return function(t,n,a){(0,a.send)("@@user/joinRequested",{name:e})}}(t))}}})(g),p=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).onSendClick=function(e){e.preventDefault();var t=n.state,a=t.message,r=t.valid,s=n.props.sendMessageFn;r&&a&&0!==a.length&&(s(a),n.setState({valid:!1,message:""}))},n.onChange=function(e){var t=e.target.value,a=t&&t.length>0;n.setState({valid:a,message:t})},n.onKeyDown=function(e){if("Enter"===e.key)return n.onSendClick(e)},n.state={valid:!1,name:null},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.valid;return r.a.createElement("div",null,r.a.createElement("input",{className:"send-message-form-input",placeholder:"Say something nice",maxLength:"200",onChange:this.onChange,onKeyDown:this.onKeyDown}),r.a.createElement("button",{onClick:this.onSendClick,disabled:!e},"Send"))}}]),t}(a.Component),v=Object(d.b)(null,function(e){return{sendMessageFn:function(t){return e(function(e){return function(t,n,a){var r=a.send;t({type:"messageSendRequested"}),r("@@user/messageAdded",{message:e})}}(t))}}})(p),b=function(e){var t=e.name,n=e.createdAt,a=e.message;return r.a.createElement("div",{className:"message"},r.a.createElement("span",{style:t&&{marginRight:"5px"}},t&&t+":"),r.a.createElement("span",{className:"text"}," \xa0 ",a," \xa0 "),r.a.createElement("span",{className:"created-at"},function(e){var t=Date.now()-e;if(t<5e3)return"just now";var n=Math.floor(t/1e3),a=Math.floor(n/31536e3);return a>1?a+" yrs ago":(a=Math.floor(n/2592e3))>1?a+" mon ago":(a=Math.floor(n/86400))>1?a+" days ago":(a=Math.floor(n/3600))>1?a+" hr ago":(a=Math.floor(n/60))>1?a+" min ago":Math.floor(n)+" sec ago"}(n)))},j=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){this.messageList.scrollTop=this.messageList.scrollHeight}},{key:"render",value:function(){var e=this,t=this.props.messages;return r.a.createElement("div",{className:"message-list"},r.a.createElement("strong",null,"Messages"),r.a.createElement("div",{className:"messages-list",ref:function(t){e.messageList=t}},t.map(function(e,t){var n=e.id,a=e.user,s=e.message,o=e.createdAt;return r.a.createElement("span",{key:t},r.a.createElement(b,{key:n,name:a&&a.name,createdAt:o,message:s}))})))}}]),t}(a.Component),y=Object(d.b)(function(e){return{messages:e.messages}})(j),O=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){this.messageList.scrollTop=this.messageList.scrollHeight}},{key:"render",value:function(){var e=this,t=this.props.users;return r.a.createElement("div",{className:"message-list"},r.a.createElement("strong",null,"Users In Chat"),r.a.createElement("div",{className:"messages-list",ref:function(t){e.messageList=t}},r.a.createElement("ul",null,t.map(function(e,t){var n=e.name;return r.a.createElement("li",{key:t},n)}))))}}]),t}(a.Component),E=Object(d.b)(function(e){return{users:e.users}})(O),k=n(20),w=n.n(k),C=Object(d.b)(function(e){return{currentUser:e.currentUser}})(function(e){var t=e.currentUser;return r.a.createElement("div",{className:"App-header"},r.a.createElement("img",{src:w.a,className:"App-logo",alt:"logo"}),r.a.createElement("section",{id:"page"},r.a.createElement("header",{className:""},r.a.createElement(E,null)),r.a.createElement("nav",null,t?r.a.createElement(v,null):r.a.createElement(h,null)),r.a.createElement("main",null,r.a.createElement(y,null))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(21);var N,S=n(8),A=n(9),M=n(10),D=(N={},Object(A.a)(N,"@@user/joinRequested",function(e){var t=e.state,n=e.payload;return Object(M.a)({},t,{currentUser:n})}),Object(A.a)(N,"@@user/userJoined",function(e){var t=e.state,n=e.payload;return Object(M.a)({},t,{users:t.users.concat([n])})}),Object(A.a)(N,"@@user/messageAdded",function(e){var t=e.state,n=e.payload,a=e.metadata.createdAt;return Object(M.a)({},t,{messages:t.messages.concat([Object(M.a)({},n,{createdAt:a})])})}),Object(A.a)(N,"@@user/usersRequested",function(e){var t=e.state,n=e.payload;return Object(M.a)({},t,{users:n})}),Object(A.a)(N,"@@user/userLeft",function(e){var t=e.state,n=e.payload.userId;return Object(M.a)({},t,{users:t.users.filter(function(e){return e.id!==n})})}),N),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,r=t.metadata,s=D[n];return s?s({state:e,payload:a,metadata:r}):e},L=n(11),x=function(){var e;return{getInstance:function(){return e||(e=function(){var e=window.location.origin.replace(/^http/,"ws");return{getSocket:function(){return new WebSocket(e)}}}()),e.getSocket()}}}(),U=function(){return new Promise(function(e,t){var n=x.getInstance(),a=function(e){n.onmessage=function(t){return e(JSON.parse(t.data))}},r=function(e,t){return n.send(JSON.stringify({type:e,payload:t}))};n.onopen=function(){return e({send:r,receive:a})},n.onclose=function(){n.close(),t(new Error("WebSocket Closed"))}})},I=new Promise(function(e,t){e(function(){var e={messages:[],users:[],currentUser:null};return U().then(function(t){var n=t.send,a=t.receive,r=[L.a.withExtraArgument({send:n})],s=Object(S.c)(J,e,S.a.apply(void 0,r));return a(s.dispatch),f(n),s}).catch(function(e){throw e})}().then(function(e){return e}))}),R=function(e){return r.a.createElement("div",null,JSON.stringify(e))};I.then(function(e){console.log("store rendered"),o.a.render(r.a.createElement(d.a,{store:e},r.a.createElement(C,null)),document.getElementById("root"))}).catch(function(e){return o.a.render(r.a.createElement(R,{error:e.toString()}),document.getElementById("root"))}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[22,2,1]]]);
//# sourceMappingURL=main.fb9bb93b.chunk.js.map